@using MP_VendorTool.Common
@using MP_VendorTool.Models.Order
@{
    ViewBag.Title = "Danh sách đề nghị thanh toán - công nợ ký gửi";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="~/Content/maincontent.css" rel="stylesheet" />
<style>
    button.btn.dropdown-toggle.btn-default.bs-placeholder {
        background: #fff;
        border: 1px solid #d0cbcb;
    }

    .content_search .form-control {
        left: 0px !important;
    }

    #popup_panel .button_popup {
        height: 30px;
        min-width: 4.6875rem;
        font-size: 14px;
        text-align: center;
    }

    .form-control[disabled] {
        background: #f7f7f7 !important;
    }

    #popup_panel {
        text-align: center !important;
    }

    #btn_Gui {
        background-color: #868686;
        color: #fff;
        padding: 3px 21px;
        margin-top: 2px;
        width: 120px;
        text-align: left;
    }

    #wp_thum_img {
        text-align: center;
    }

    img#thum_img {
        height: 70px;
    }

    input, select, textarea {
        max-width: 280px;
    }

    .btn-info {
        padding: 4px !important;
        text-align: left;
        max-width: 150px;
        border: none;
    }

    #tbl_Item {
        margin-top: 0px;
        font-size: 12px;
    }

    .content_search label {
        font-size: 12px;
        text-align: left !important;
        padding-top: 6px;
    }

    .btn-info:hover {
        color: #fff;
        background-color: #868686;
        border-color: #868686;
    }

    .btn:hover, .btn:focus, .btn.focus {
        color: #fff;
        background-color: #868686;
        border-color: #868686;
    }

    .wp_hearder {
        padding: 5px 0px;
        background-color: #868686;
        position: fixed;
        z-index: 999;
        top: 0;
        height: 65px !important;
        width: 100%;
    }

    .table thead {
        height: 50px !important;
    }

    .btn_search {
        background-color: #868686;
        color: #fff;
        width: 100%;
        height: 23px;
        margin-bottom: 4px;
        padding: 2px 6px !important;
        text-align: left;
        font-size: 12px;
    }

    .wp_table {
        padding-top: 134px;
    }

    /*#wp_order {
        background-image: url('../../image/nen2.jpg');
        background-color: #f3f3f3;*/ /* Used if the image is unavailable */
    /*background-size: cover;
    }*/

    body {
        font-size: 12px;
    }

    .wp_table {
        width: 90%;
        margin: 0 auto;
    }

    .logo img {
        width: 250px;
    }

    .header_title {
        text-align: center;
        text-transform: uppercase;
        color: #fff;
        font-size: 28px;
        font-weight: bold;
    }

    .header_vender {
        background-color: #868686;
        padding: 18px 0px;
    }

    table.dataTable.no-footer {
        border-bottom: 1px solid #bdbdbd !important;
    }

    .text_home {
        float: right;
        margin-top: 14px;
    }

        .text_home a {
            font-size: 18px;
            color: #fff;
            font-weight: bold;
        }

    .content_search .form-group {
        margin-bottom: 1px !important;
    }

    .content_search .form-control {
        height: 25px !important;
        padding: 0px !important;
        max-width: 280px !important;
        width: 280px !important;
    }

    .content_search label {
        font-size: 12px;
    }

    table.dataTable tbody th, table.dataTable tbody td {
        padding: 3px 10px !important;
    }

    #tbl_Item tbody {
        background-color: #ffff;
    }

    #tbl_Item thead th {
        font-size: 12px;
        text-align: left;
        /*height: 50px;*/
        vertical-align: top;
    }

    #tbl_Item thead {
        background-color: #c3c3c3;
    }

        #tbl_Item thead span {
            color: #e45050;
            font-size: 11px;
        }

    .content_table {
        padding-bottom: 72px;
    }

    #tbl_Item_length {
        position: absolute;
        bottom: 0px;
        left: 182px;
    }

    .btn_detail {
        color: #525252;
        font-size: 11px;
        border: 0px;
        padding: 4px;
        border-radius: 69px;
    }

    table.dataTable thead th, table.dataTable thead td {
        padding: 1px 5px !important;
        border-bottom: 1px solid #f1f1f1 !important;
        font-size: 11px !important;
    }

    .table > tr > td {
        padding: 1px 5px !important;
        border-bottom: 1px solid #f1f1f1 !important;
        font-size: 11px !important;
    }

    .container_1 {
        width: 95% !important;
        margin: 0 auto !important;
    }

    .rank2 {
        padding-bottom: 5px;
        width: 173px;
        padding-left: 14px;
        padding-right: 6px;
    }

    .container1 {
        width: 1300px;
        margin: auto;
    }

    table {
        width: 100%;
    }

    td {
        border: 1px solid black;
        width: 200px;
    }

    .hack1 {
        display: table;
        table-layout: fixed;
        width: 100%;
    }

    .hack2 {
        display: table-cell;
        overflow-x: auto;
        width: 100%;
    }

    .col {
        width: 10%
    }

    .modal tbody tr td {
        text-align: center
    }

    .dropdown.bootstrap-select.form-control {
        padding: 0px;
        margin: 0px;
        background: none;
        width: 100%;
        max-width: 100%;
        padding-left: 0px !important;
        border: none !important;
    }

    .col-sm-8 .btn {
        height: 26px;
        line-height: 11px
    }

    button.btn.dropdown-toggle.btn-default {
        padding: 6px 9px 4px 4px !important
    }

    .dropdown.bootstrap-select.form-control.bs3 {
        padding-bottom: 1px;
    }

    .bootstrap-select .dropdown-toggle .filter-option-inner-inner {
        overflow: hidden;
        height: 17px;
        padding: 0px;
        font-size: 12px;
        color: #59595B;
        max-width: 280px;
    }

    .col-sm-9 .btn {
        height: 27px;
        line-height: 13px;
    }
</style>
@Html.Partial("~/Views/Shared/_sidebar_3.cshtml")
<div id="wp_order">
    <div class="header_vender_1">
        @Html.Partial("~/Views/Shared/_header_home.cshtml")
    </div>
    <div class="content_order">
        <div class="container searchfrom">
            <div class="content_search">
                <div class="row">
                    <div class="col-md-4">
                        <div class="box_with">
                            <div class="form-group row">
                                <label for="textMien" class="col-sm-4 col-form-label">Nhà cung cấp</label>
                                <div class="col-sm-8">
                                    @if (Session["VendorName"] != null && Session["VendorName"].ToString().Length > 0)
                                    {
                                        <input type="text" class="form-control" id="VendorNo" name="VendorNo" value="@Session["VendorCode"] - @Session["VendorName"]" disabled style=" padding-left: 7px !important; ">
                                    }
                                    else
                                    {
                                        string FullQuyen = "B88888,B00004,B10926,B14046,B13381,B13881";
                                        string[] strArray = FullQuyen.ToString().Split(new char[] { ',' });
                                        bool Show = false;
                                        for (int i = 0; i < strArray.Length; i++)
                                        {
                                            if (strArray[i].ToString() == Session["uid"].ToString())
                                            {
                                                Show = true;
                                            }
                                        }
                                        if (Show == true)
                                        {
                                            <select id="VendorNo" class="form-control selectpicker" data-live-search="true" onchange="js_searchbox();">
                                                @if (ViewBag.list_vendor != null)
                                                {
                                                    <option value="">--- Chọn NCC ---</option>
                                                    foreach (MP_VendorTool.Models.Order.objCombox box in (List<MP_VendorTool.Models.Order.objCombox>)ViewBag.list_vendor)
                                                    {
                                                        <option value="@box.Code - @box.Name">@box.Code - @box.Name</option>
                                                    }
                                                }
                                            </select>
                                        }
                                        else
                                        {
                                            <input type="text" class="form-control" id="VendorNo" name="VendorNo" value="" disabled>
                                        }
                                    }
                                </div>
                            </div>

                            <div class="form-group row">
                                <label for="textMien" class="col-sm-4 col-form-label">Kỳ công nợ</label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="Thang" onclick="js_searchbox();">
                                        <option value="">--Chọn Tháng--</option>
                                        <option value="1">Tháng 1</option>
                                        <option value="2">Tháng 2</option>
                                        <option value="3">Tháng 3</option>
                                        <option value="4">Tháng 4</option>
                                        <option value="5">Tháng 5</option>
                                        <option value="6">Tháng 6</option>
                                        <option value="7">Tháng 7</option>
                                        <option value="8">Tháng 8</option>
                                        <option value="9">Tháng 9</option>
                                        <option value="10">Tháng 10</option>
                                        <option value="11">Tháng 11</option>
                                        <option value="12">Tháng 12</option>
                                    </select>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-1"> </div>
                    <div class="col-md-4">
                        <div class="box_with">
                            <div class="form-group row">
                                <label for="textMien" class="col-sm-4 col-form-label">Chọn năm</label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="Nam" onchange="js_searchbox();">
                                        @Html.Raw(ViewBag.ShowNam)
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="ContractNo" class="col-sm-4 col-form-label">Trạng thái</label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="TrangThai" onclick="js_searchbox();">
                                        <option value="">--Chọn trạng thái--</option>
                                        <option value="1">BBM xác nhận</option>
                                        <option value="2">NCC xác nhận</option>
                                        <option value="3">Hoàn thành</option>
                                    </select>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="col-md-3" style="text-align: left;">
                        <a href="/Report/ReportDepositDetail" style="text-align: left; max-width: 150px; float: left; width: 150px; text-align: center" class="btn btn-secondary btn_search"><i class="fa fa-forward" aria-hidden="true" style="margin-top: 3px; margin-right: 3px; "></i> Đơn hàng</a>
                    </div>
                </div>
            </div>

        </div>
        <div class="wp_table" style="margin-top: 9px">
            <div class="card-body">
                <div class="table-responsive_2" id="div-content">
                    @Html.Partial("~/Views/Report/Partial/__ReportDeposit.cshtml")
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('#txtHead').html("Danh sách đề nghị thanh toán - công nợ ký gửi");
        $('#f_dev').html("");
        $('#f_header').html("");
        $('#v_review').hide();
        $('#v_view').hide();
        $('#v_approve').hide();
        js_GetList();
    });
    function js_searchbox() {
        js_GetList();
    }
    function js_ReloadTable() {
        $('#tbl_Item').DataTable({
            lengthMenu: [[200, 50, 70, 100, -1], [200, 50, 70, 100]],
            //columnDefs: [
            //    //{ 'targets': 0, 'searchable': false, 'orderable': false },
            //    { 'targets': 9, 'searchable': false, 'orderable': false },
            //    { 'targets': 10, 'searchable': false, 'orderable': false },
            //    { 'targets': 11, 'searchable': false, 'orderable': false },
            //    { 'targets': 12, 'searchable': false, 'orderable': false },
            //    { 'targets': 13, 'searchable': false, 'orderable': false },
            //    { 'targets': 14, 'searchable': false, 'orderable': false },
            //    { 'targets': 15, 'searchable': false, 'orderable': false },
            //],
            //"order": [[0, "desc"]],
            "searching": false,
            // fixedHeader: true,
            fixedHeader: {
                headerOffset: 141
            },
            autoWidth: false,
            "language": {
                "emptyTable": "Không có dữ liệu !"
            }
        });
    }

    function js_GetList() {
        var VendorNo = fomart_split($('#VendorNo').val().trim(), 0);
        var KyCongNo = $('#KyTinhCongNo').val();
        var Nam = $('#Nam').val();
        var TrangThai = $('#TrangThai').val();

        $.ajax({
            url: '/Report/GetList_ReportDeposit_Header',//GetList_ReportDeposit_Header
            type: 'POST',
            data: JSON.stringify({ VendorNo: VendorNo, KyCongNo: KyCongNo, Nam: Nam, TrangThai: TrangThai }),
            contentType: 'application/json, charset=utf-8',
            beforeSend: function () {
                js_Loading(true, 1);
            },
            success: function (data) {
                $("#div-content").find('tbody').empty();
                $('#div-content').html(data);
                js_ReloadTable();
                js_Loading(false, 1);
            },
            error: function () {
                js_Loading(false, 1);
            }
        });
    }


</script>
